@page
@model IndexModel
@{
    ViewData["Title"] = "SLA Dashboard";
}
<div style="font-family:system-ui, -apple-system, Segoe UI, Roboto; padding:24px; max-width:1100px; margin:0 auto;">
  <h1 style="margin-bottom:16px;">SLA Dashboard</h1>
  <p style="color:#666; margin-bottom:24px;">Live KPIs from your tickets dataset.</p>

  <div style="display:grid; grid-template-columns: repeat(4, 1fr); gap:12px; margin-bottom:24px;">
    <div id="kpi-open"     style="background:#f5f7ff; padding:16px; border-radius:10px;"></div>
    <div id="kpi-21"       style="background:#fff7e6; padding:16px; border-radius:10px;"></div>
    <div id="kpi-7"        style="background:#fff1f0; padding:16px; border-radius:10px;"></div>
    <div id="kpi-overdue"  style="background:#ffe6e6; padding:16px; border-radius:10px;"></div>
  </div>

  <a href="/Tickets" style="display:inline-block; padding:10px 14px; background:#0a7; color:white; border-radius:8px; text-decoration:none;">View Tickets →</a>
</div>

<script>
(async () => {
  const res = await fetch('/api/kpi/summary');
  const k = await res.json();

  const card = (label, value) => `
    <div style="display:flex; flex-direction:column;">
      <span style="font-size:13px; color:#555">${label}</span>
      <strong style="font-size:28px;">${value}</strong>
    </div>`;

  document.getElementById('kpi-open').innerHTML    = card('Open Tickets', k.open);
  document.getElementById('kpi-21').innerHTML      = card('Due ≤ 21 days', k.dueIn21);
  document.getElementById('kpi-7').innerHTML       = card('Due ≤ 7 days',  k.dueIn7);
  document.getElementById('kpi-overdue').innerHTML = card('Overdue',       k.overdue);
})();
</script>
